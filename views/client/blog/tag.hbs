<!DOCTYPE html>
<html lang="ko">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	{{>cl-seo title="블로그 - 데브현" description="블로그에 작성된 다양한 포스트들을 태그별로 분류해서 하였습니다."}}

	{{>cl-style}}

</head>

<body>

	{{>cl-loader}}

	{{>cl-header active='blog' fix='fix'}}

	<main id="contents" class="blog">
		<div>
			<h2 class="hide">현재 화면 위치</h2>
			<section class="location">
				<div>
					<p>
						<span class="path">데브현 메인</span>
						<span class="path on">블로그</span>
					</p>
				</div>
			</section>
			<h2 class="hide">타이틀</h2>
			<section class="title">
				<div>
					<h2>
						개발과 관련된 다양한 이야기들을
						<br class="visual_pc">
						정성을 담아 기록하고 있어요
					</h2>
					<div class="count">
						<ul>
							<li>
								<h3>발행 포스트</h3>
								<p>{{count.post_count}} <span>건</span></p>
							</li>
							<li>
								<h3>관련 태그</h3>
								<p>{{count.tag_count}} <span>개</span></p>
							</li>
						</ul>
					</div>
				</div>
			</section>

			<section class="tab">
				<div>
					<ul>
						<li><a href="/blog/post">포스트</a></li>
						<li><a href="/blog/series">시리즈</a></li>
						<li><a href="/blog/tag" class="on">태그</a></li>
					</ul>
					<div id="searchFilter" class="filter visual_mobile">
						<i class="mdi mdi-filter"></i>
					</div>
					<div class="search">
						<form method="POST" onsubmit="APP.searchTag(); return false;">
							<input type="text" name="query" id="query" placeholder="태그 검색">
							<button type="submit"></button>
						</form>
					</div>
				</div>
			</section>

			<section class="tag_list">
				<div>
					{{#each tags}}
					<a href="/blog/tag/{{tag}}">
						<span class="name">{{tag}}</span>
						<span class="count">{{count}}</span>
					</a>
					{{/each}}
				</div>
			</section>

		</div>
	</main>

	{{>cl-footer}}

	{{>cl-script}}

	<script>
		window.APP = {
			searchTag: function () {
				var form = $(event.target).serializeObject();
				location.href = '/blog/tag/' + form.query;
			},
			pagination: function () {
				var totalPages = parseInt('{{postList.totalPage}}') || 1;
				var startPage = parseInt('{{postList.page}}') + 1 || 1;

				$('#page').twbsPagination({
					totalPages: totalPages,
					startPage: totalPages >= startPage ? startPage : 1,
					visiblePages: 5,
					first: '처음페이지로 이동',
					last: '마지막페이지로 이동',
					prev: '이전페이지로 이동',
					next: '다음페이지로 이동',
					onPageClick: function (event, page) {
						if (startPage == page) return;
						if (location.href.indexOf('page') == -1) {
							var isQuery = location.href.indexOf('?') >= 0;
							location.href = location.href + (isQuery ? '&' : '?') + 'page=' + page;
						} else {
							location.href = location.href.replace(/page=.+/g, 'page=' + page);
						}

					}
				});
			},
			query: function () {
				$('.search input').focus(function () {
					$('.search').addClass('focus');
				});

				$('.search input').blur(function (event) {
					var value = event.target.value;
					if (value == '') {
						$('.search').removeClass('focus');
					} else {
						$('.search').addClass('focus');
					}

				});
			},
			init: function () {
				APP.pagination();
				APP.query();
			}
		}
		$(document).ready(function () { APP.init() });
	</script>

</body>

</html>