<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>회원 통계 - {{APP}}</title>

  {{>ad-style}}

</head>

<body class="az-body az-body-sidebar az-body-dashboard-nine az-white-box">

  {{>ad-hdn}}

  <div id="progress"></div>

  {{>ad-menu active='stmember'}}

  <div class="az-content az-content-dashboard-nine">

    {{>ad-header}}

    <div class="az-content-header">
      <div class="az-content-header-top">
        <div>
          <h2 class="az-content-title mg-b-5 mg-b-lg-8">회원 통계</h2>
          <p class="mg-b-0">회원 기본정보를 바탕으로한 통계 정보입니다.</p>
        </div>
      </div>

    </div>
    <div class="az-content-body">

      <div class="row row-sm">
        <div class="col-12 col-md-4 mg-b-20">
          <div class="col-12 mg-t-0 mg-b-20 p-0">
            <div class="card card-dashboard-three" style="background-color:#fff;">
              <div class="card-header">
                <p>
                  전체 회원수
                </p>
                <h6>
                  {{decimal memberData.rcount}}
                </h6>
                <small><span id="nowDate"></span> 기준 회원 수</small>
              </div>

              <div class="card-body">
                <div class="chart" style="padding-bottom: 5px;">
                  <canvas id="memberCountChart"></canvas>
                </div>
              </div>
            </div>
          </div>

          <div class="col-12 mg-t-0 p-0">
            <div class="card card-body ht-xl-100p card-dashboard-five">
              <h6 class="card-title tx-14 mg-b-10">성별 비율</h6>
              <p class="mg-b-15 card-text">현재 가입된 회원의 성별 비율 입니다.</p>
              <div class="d-flex flex-column align-items-center mg-b-25">
                <canvas id="genderChart"></canvas>
              </div>
              <div class="row row-sm">
                <div class="col-6 text-center">
                  <label><span class="bg-indigo"></span> 남성</label>
                  <h5>{{decimal memberData.man}}</h5>
                </div>
                <div class="col-6 text-center">
                  <label><span class="bg-gray-500"></span> 여성</label>
                  <h5>{{decimal memberData.woman}}</h5>
                </div>
              </div>
            </div>
          </div>

        </div>

        <div class="col-12 col-md-8 mg-b-20">
          <div class="card card-dashboard-four">
            <div class="more"><a href="javascript:void(0);" data-toggle="modal" data-target="#modalAge"><i
                  class="fas fa-external-link-alt mg-r-5"></i>표 형식</a></div>
            <div class="card-header">
              <h6 class="card-title mg-b-5-f">연령대별 회원수</h6>
              <p class="mg-b-20 card-text" style="font-size: 12px;">현재 가입된 회원의 연령별 회원 수 입니다.</p>
            </div>
            <div class="card-body row" style="height: 450px;">
              <canvas id="ageChart"></canvas>
            </div>
          </div>
        </div>

        <div class="col-lg-12 mg-b-20">
          <div class="card card-dashboard-four">
            <div class="more"><a href="javascript:void(0);" data-toggle="modal" data-target="#modalArea"><i
                  class="fas fa-external-link-alt mg-r-5"></i>표 형식</a></div>
            <div class="card-header">
              <h6 class="card-title mg-b-5-f">지역별 회원수</h6>
              <p class="mg-b-20 card-text" style="font-size: 12px;">현재 가입된 회원의 지역별 회원 수 입니다.</p>
            </div>
            <div class="card-body row">
              <canvas id="areaChart"></canvas>
            </div>
          </div>
        </div>

      </div>
    </div>
  </div>

  {{!-- 연령대별 회원수 표 형식 --}}
  <div id="modalAge" class="modal effect-scale">
    <div class="modal-dialog modal-lg modal-dialog-centered" role="document" style="max-width: 950px;">
      <div class="modal-content modal-content-demo">
        <div class="modal-header">
          <h6 class="modal-title">연령대별 회원수 정보</h6>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <div class="table-responsive">
            <table class="table az-table-reference mg-b-0">
              <thead>
                <tr>
                  <td class="td-header text-center" style="width: 6%;">10대 미만</td>
                  <td class="td-header text-center" style="width: 6%;">10대</td>
                  <td class="td-header text-center" style="width: 6%;">20대</td>
                  <td class="td-header text-center" style="width: 6%;">30대</td>
                  <td class="td-header text-center" style="width: 6%;">40대</td>
                  <td class="td-header text-center" style="width: 6%;">50대</td>
                  <td class="td-header text-center" style="width: 6%;">60대</td>
                  <td class="td-header text-center" style="width: 6%;">70대</td>
                  <td class="td-header text-center" style="width: 6%;">80대</td>
                  <td class="td-header text-center" style="width: 6%;">90대</td>
                  <td class="td-header text-center" style="width: 6%;">90대 초과</td>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="text-center">{{memberData.uteens}}</td>
                  <td class="text-center">{{memberData.teens}}</td>
                  <td class="text-center">{{memberData.twenties}}</td>
                  <td class="text-center">{{memberData.thirties}}</td>
                  <td class="text-center">{{memberData.forties}}</td>
                  <td class="text-center">{{memberData.fifties}}</td>
                  <td class="text-center">{{memberData.sixties}}</td>
                  <td class="text-center">{{memberData.seventies}}</td>
                  <td class="text-center">{{memberData.eighties}}</td>
                  <td class="text-center">{{memberData.nineties}}</td>
                  <td class="text-center">{{memberData.onineties}}</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-indigo" data-dismiss="modal">닫기</button>
        </div>
      </div>
    </div>
  </div>

  {{!-- 지역별 회원수 표 형식 --}}
  <div id="modalArea" class="modal effect-scale">
    <div class="modal-dialog modal-lg modal-dialog-centered" role="document" style="max-width: 950px;">
      <div class="modal-content modal-content-demo">
        <div class="modal-header">
          <h6 class="modal-title">지역별 회원수 정보</h6>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <div class="table-responsive">
            <table class="table az-table-reference mg-b-0">
              <thead>
                <tr>
                  <td class="td-header text-center" style="width: 5%;">서울</td>
                  <td class="td-header text-center" style="width: 5%;">경기</td>
                  <td class="td-header text-center" style="width: 5%;">인천</td>
                  <td class="td-header text-center" style="width: 5%;">강원</td>
                  <td class="td-header text-center" style="width: 5%;">충북</td>
                  <td class="td-header text-center" style="width: 5%;">세종</td>
                  <td class="td-header text-center" style="width: 5%;">충남</td>
                  <td class="td-header text-center" style="width: 5%;">대전</td>
                  <td class="td-header text-center" style="width: 5%;">경북</td>
                  <td class="td-header text-center" style="width: 5%;">대구</td>
                  <td class="td-header text-center" style="width: 5%;">울산</td>
                  <td class="td-header text-center" style="width: 5%;">부산</td>
                  <td class="td-header text-center" style="width: 5%;">경남</td>
                  <td class="td-header text-center" style="width: 5%;">전북</td>
                  <td class="td-header text-center" style="width: 5%;">전남</td>
                  <td class="td-header text-center" style="width: 5%;">광주</td>
                  <td class="td-header text-center" style="width: 5%;">제주</td>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="text-center">{{memberData.seoul}}</td>
                  <td class="text-center">{{memberData.gyeonggi}}</td>
                  <td class="text-center">{{memberData.incheon}}</td>
                  <td class="text-center">{{memberData.gangwon}}</td>
                  <td class="text-center">{{memberData.chungbuk}}</td>
                  <td class="text-center">{{memberData.sejong}}</td>
                  <td class="text-center">{{memberData.chungnam}}</td>
                  <td class="text-center">{{memberData.daejeon}}</td>
                  <td class="text-center">{{memberData.gyeongbuk}}</td>
                  <td class="text-center">{{memberData.daegu}}</td>
                  <td class="text-center">{{memberData.ulsan}}</td>
                  <td class="text-center">{{memberData.busan}}</td>
                  <td class="text-center">{{memberData.gyeongnam}}</td>
                  <td class="text-center">{{memberData.jeonbuk}}</td>
                  <td class="text-center">{{memberData.jeonnam}}</td>
                  <td class="text-center">{{memberData.gwangju}}</td>
                  <td class="text-center">{{memberData.jeju}}</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-indigo" data-dismiss="modal">닫기</button>
        </div>
      </div>
    </div>
  </div>

  {{>ad-script}}
  <script>
    window.APP = {
      init: function () { // 초기 스크립트 실행

        var cfc = {{{ memberCount.data
    }}};
    var cfcMax = Math.max.apply(null, cfc);

    // 회원 수 차트
    var memberCountChart = new Chart(document.getElementById('memberCountChart').getContext('2d'), {
      type: 'bar',
      data: {
        labels: (function () {
          let temp = [];
          for (let i = 0; i < cfc.length; i++) {
            temp.push(i);
          }
          return temp;
        })(),
        datasets: [{
          data: cfc,
          backgroundColor: '#560bd0'
        }]
      },
      options: {
        maintainAspectRatio: false,
        tooltips: {
          enabled: false
        },
        legend: {
          display: false,
          labels: {
            display: false
          }
        },
        scales: {
          yAxes: [{
            display: false,
            ticks: {
              beginAtZero: true,
              fontSize: 11,
              max: cfcMax * 2
            }
          }],
          xAxes: [{
            display: false,
            ticks: {
              beginAtZero: true,
              fontSize: 11,
              display: false
            }
          }]
        },
        plugins: {
          datalabels: {
            display: false
          }
        }
      }
    });

    // 회원 성별 비율 차트 초기화
    var statusMan = parseInt('{{memberData.man}}') || 0;
    var statusWoman = parseInt('{{memberData.woman}}') || 0;

    var genderChart = new Chart(document.getElementById('genderChart'), {
      type: 'doughnut',
      data: {
        labels: ['남성', '여성'],
        datasets: [{
          data: [statusMan, statusWoman],
          backgroundColor: ['#007bff', '#6f42c1']
        }]
      },
      options: {
        maintainAspectRatio: false,
        responsive: true,
        legend: {
          display: false,
        },
        animation: {
          animateScale: true,
          animateRotate: true
        },
        plugins: {
          datalabels: {
            display: false
          }
        }
      }
    });

    // 연령대별 회원수 차트 초기화
    var ageChart = new Chart(document.getElementById('ageChart').getContext('2d'), {
      type: 'horizontalBar',
      data: {
        labels: ['10대 미만', '10대', '20대', '30대', '40대', '50대', '60대', '70대', '80대', '90대', '90대 초과'],
        datasets: [{
          label: '회원 수',
          data: (function () {
            let data = [];
            data.push({{ memberData.uteens }});
          data.push({{ memberData.teens }});
    data.push({{ memberData.twenties }});
    data.push({{ memberData.thirties }});
    data.push({{ memberData.forties }});
    data.push({{ memberData.fifties }});
    data.push({{ memberData.sixties }});
    data.push({{ memberData.seventies }});
    data.push({{ memberData.eighties }});
    data.push({{ memberData.nineties }});
    data.push({{ memberData.onineties }});
    return data;
          }) (),
      backgroundColor: ['#560bd0', '#007bff', '#00cccc', '#cbe0e3', '#74de00', '#f10075', '#a6c96a', '#4572A7', '#AA4643', '#89A54E', '#80699B']
        }]
      },
    options: {
      maintainAspectRatio: false,
        legend: {
        display: false,
          labels: {
          display: false
        }
      },
      scales: {
        yAxes: [{
          ticks: {
            beginAtZero: true,
            fontSize: 10,
          }
        }],
          xAxes: [{
            ticks: {
              beginAtZero: true,
              fontSize: 11,
              max: cfcMax
            }
          }]
      },
      plugins: {
        datalabels: {
          color: '#fff',
            display: function (context) {
              return context.dataset.data[context.dataIndex] != 0;
            },
          anchor: 'center'
        }
      }
    }
    });

    // 지역별 회원수 차트 초기화
    var areaData = (function () {
      let data = [];
      data.push({{ memberData.seoul }});
    data.push({{ memberData.gyeonggi }});
    data.push({{ memberData.incheon }});
    data.push({{ memberData.gangwon }});
    data.push({{ memberData.chungbuk }});
    data.push({{ memberData.sejong }});
    data.push({{ memberData.chungnam }});
    data.push({{ memberData.daejeon }});
    data.push({{ memberData.gyeongbuk }});
    data.push({{ memberData.daegu }});
    data.push({{ memberData.ulsan }});
    data.push({{ memberData.busan }});
    data.push({{ memberData.gyeongnam }});
    data.push({{ memberData.jeonbuk }});
    data.push({{ memberData.jeonnam }});
    data.push({{ memberData.gwangju }});
    data.push({{ memberData.jeju }});
    return data;
    }) ();

    const areaChart = new Chart(document.getElementById('areaChart').getContext('2d'), {
      type: 'bar',
      data: {
        labels: ['서울', '경기', '인천', '강원', '충북', '세종', '충남', '대전', '경북', '대구', '울산', '부산', '경남', '전북', '전남', '광주', '제주'],
        datasets: [{
          label: '회원 수',
          data: areaData,
          backgroundColor: ['#560bd0', '#007bff', '#00cccc', '#cbe0e3', '#74de00', '#f10075', '#a6c96a', '#4572A7', '#AA4643', '#89A54E', '#80699B', '#3D96AE',
            '#DB843D', '#92A8CD', '#A47D7C', '#B5CA92', '#0d233a']
        }]
      },
      options: {
        maintainAspectRatio: false,
        legend: {
          display: false,
          labels: {
            display: false
          }
        },
        scales: {
          yAxes: [{
            ticks: {
              beginAtZero: true,
              fontSize: 10,
              max: cfcMax
            }
          }],
          xAxes: [{
            ticks: {
              beginAtZero: true,
              fontSize: 11
            }
          }]
        },
        plugins: {
          datalabels: {
            color: '#fff',
            display: function (context) {
              return context.dataset.data[context.dataIndex] != 0;
            },
            anchor: 'center'
          }
        }
      }
    });

      }
    }
    $(document).ready(function () {
      APP.init();
    });
  </script>

</body>

</html>